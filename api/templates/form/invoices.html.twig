{% block invoice_detail_list_widget %}
    <div class="col-md-12">
        <div class="col-xs-1">

        </div>
        <div class="col-xs-11">
            <div class="col-md-12" style="padding:0 0 0 8px">
                <div class="col-md-8">
                    <label>concepto</label>
                </div>
                <div class="col-md-1">
                    <label>unidades</label>
                </div>
                <div class="col-md-1">
                    <label>precio / unid</label>
                </div>
                <div class="col-md-1">
                    <label>descuento</label>
                </div>
                <div class="col-md-1">
                    <label>subtotal</label>
                </div>
            </div>
        </div>
    </div>

    <div class="col-md-12">
        {{ form_widget(form) }}
    </div>

    <div class="col-md-12">
        <div class="col-xs-1"></div>
        <div class="col-xs-11">
            <div class="col-md-12" style="padding:0 0 0 8px; text-align: right">
                <div class="col-md-1 col-md-offset-10" style="text-align: right">
                    <label>IMPORTE: </label>
                </div>
                <div class="col-md-1">
                    <span class="price">
                        <span class="num" style="font-size: 1.2em"></span>&nbsp;
                        <span class="fa fa-euro"></span>
                    </span>
                </div>
            </div>

            <div class="col-md-12" style="padding:0 0 0 8px; text-align: right">
                <div class="col-md-1 col-md-offset-10">
                    <label>DESCUENTO: </label>
                </div>
                <div class="col-md-1">
                    <span class="discount">
                        <span class="num" style="font-size: 1.2em"></span>&nbsp;
                        <span class="fa fa-euro"></span>
                    </span>
                </div>
            </div>

            <div class="col-md-12" style="padding:0 0 0 8px; text-align: right">
                <div class="col-md-1 col-md-offset-10">
                    <label>TOTAL: </label>
                </div>
                <div class="col-md-1">
                    <span class="total">
                        <span class="num" style="font-size: 1.2em"></span>&nbsp;
                        <span class="fa fa-euro"></span>
                    </span>
                </div>
            </div>
        </div>
    </div>


    <script type="application/javascript">
        $(function () {
            var calcule_total = function () {
                var price = 0;
                var total = 0;

                $('[name$="[price]"]').each(function () {
                    price += $(this).val() * 1.0;
                });

                $('[name$="[total]"]').each(function () {
                    total += $(this).val() * 1.0;
                });

                $('.price .num').text(price.toFixed(2))
                $('.total .num').text(total.toFixed(2))

                $('.discount .num').text((total - price).toFixed(2))
            };

            var update = function () {
                var row = $(this).parents('.detail');
                var numOfUnits = row.find('[name$="[numOfUnits]"]').val() * 1;
                var amount = row.find('[name$="[price]"]').val() * 1.0;
                var discount = row.find('[name$="[discount]"]').val() * 1.0;
                var total = row.find('[name$="[total]"]');

                var partial = amount - (amount * (discount / 100));

                var value = numOfUnits * partial;
                $(total).val(value)
                calcule_total()
            };

            calcule_total();
            $(document).on("change", '.detail input', update);

        })

    </script>

{% endblock %}

{% block invoice_detail_widget %}
    <div class="col-md-12 detail">
        <div class="col-md-8">
            {{ form_row(form.subject) }}
        </div>

        <div class="col-md-1">
            {{ form_row(form.numOfUnits) }}
        </div>

        <div class="col-md-1">
            {{ form_row(form.price) }}
        </div>

        <div class="col-md-1">
            {{ form_row(form.discount) }}
        </div>

        <div class="col-md-1">
            {{ form_row(form.total) }}
        </div>
    </div>
{% endblock %}
