{% extends get_global_template('layout') %}

{% block content %}

    <div id="calendar"/>
    <script>
        document.addEventListener('DOMContentLoaded', function () {

            var calendarEl = document.getElementById('calendar');

            var calendar = new FullCalendar.Calendar(calendarEl, {
                plugins: ['resourceTimeGrid'],
                locale: 'es',
                timeZone: 'UTC',
                titleFormat: { year: 'numeric', month: 'long', day: 'numeric', weekday: 'long' },
                defaultView: 'resourceTimeGridDay',
                minTime: '09:00:00',
                maxTime: '23:00:00',
                allDaySlot: false,
                slotDuration: '00:05:00',
                slotLabelFormat: {
                    hour: 'numeric',
                    minute: '2-digit',
                    omitZeroMinute: false,
                    meridiem: 'short'

                },
                resources: {{ classRooms | raw }},
                events: '{{ path(events_route) }}',
                eventRender: function (info) {

                    var data = info.event.extendedProps;
                    var attendances = $('<div class="attendance_sumary"><br/></div>');

                    $.each(data.attendances, (index, attendance)=>{
                        attendances.append(`<span class=${attendance.status} title="${attendance.student}"></span>`);
                    });

                    $(info.el).find('.fc-time').html(data.schedule);
                    $(info.el).find('.fc-title').html(`<p>${info.event.title}</p>`);
                    $(info.el).find('.fc-title').append(attendances);

                }

            });

            calendar.render();
        });

    </script>
{% endblock %}
